{% extends 'base.html' %}
{% load i18n %}

{% block css %}
{% endblock %}

{% block content %}

<h1>Backoffice / Shipping</h1>
{% include "back/_nav.html" %}

<!--
<table width="50%">
	<thead><tr><th colspan="2">Choices</th></tr></thead>
	<tbody>
	<tr><td>Tinybox</td><td>{{ a_count }} ({% widthratio a_count|floatformat:"2" total_count|floatformat:"2" 100 %}%)</td></tr>
	<tr><td>Bigbox</td><td>{{ b_count }} ({% widthratio b_count|floatformat:"2" total_count|floatformat:"2" 100 %}%)</td></tr>
	<tr><td>Sumobox</td><td>{{ c_count }} ({% widthratio c_count|floatformat:"2" total_count|floatformat:"2" 100 %}%)</td></tr>
	<tr><td>Total</td><td>{{ total_count }}</td></tr>
	</tbody>
</table>
-->

<div class="panel">
<h4>Packing list</h4>

{% for box in boxes_this_month %}
	<table width="100%">
		<thead><tr><th colspan="3">{{ box }}</th><th>{{ box.order_set.count }}</th></tr></thead>
		<tbody>
			{% for ramen in box.ramens.all %}
			<tr>
				<td>{{ forloop.counter }}</td>
				<td><a href="{% url ramen_detail ramen.id %}">{{ ramen }}</a></td>
				<td>{{ ramen.weight }}</td>
				<td>{{ ramen.cogs }}</td>
			</tr>
			{% endfor %}
			<tr><td></td><td></td><td>Total cost:</td><td>{{ box.cost }}</td></tr>
			<tr><td></td><td></td><td>Total weight:</td><td>{{ box.weight }}</td></tr>
		</tbody>
	</table>

	<form action="" method="post">{% csrf_token %}
		<table width="100%">
			<tr>
				<td><input type="text" name="amt" placeholder="amount"></td>
				<td>
					<input type="submit" value="Packed">
				</td>
			</tr>
		</table>
	</form>
{% endfor %}
</div>

<div class="panel">
<h4>Packed</h4>
</div>

<div class="panel">
<h4>Shipping list</h4>
<ul>
{% for order in unshipped_list|slice:":25" %}
	<li>{{ order }} - {{ order.user.profile.ship_state }}</li>
{% endfor %}
</ul>
</div>

<div class="panel">
<h4>Shipped</h4>
</div>

<hr>

<h4>Costs</h4>
<table width="50%">
	<thead><tr><th colspan="2">States</th><th>Customers</th><th>Avg</th><th>Max</th><th>Sum</th></tr></thead>
	<tbody>
	{% for i in states %}
	<tr><td width="10%">{{ forloop.counter }}</td><td>{{ i.ship_state }}</td><td>{{ i.customers }} ({% widthratio i.customers|floatformat:"2" total_count|floatformat:"2" 100 %}%)</td><td>${{ i.avg }}</td><td>${{ i.max }}</td><td>${{ i.sum }}</td></tr>
	{% endfor %}
	</tbody>
</table>

<p>Total: {{ total_count }}</p>

{% endblock %}