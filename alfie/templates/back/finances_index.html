{% extends 'base.html' %}
{% load i18n %}
{% load humanize %}

{% block css %}
{% endblock %}

{% block content %}
{% include "back/_nav.html" %}

<h1>Backoffice / Finances</h1>
<div class="panel">This shows finance information about orders.</div>

<table class="twelve">
	<thead>
		<tr><th>MAR</th><th>{{ this_months_book.this_month_count }} orders</th></tr>
	</thead>
	<tbody>
		<tr><td>Revenue</td><td>${{ this_months_book.revenue|floatformat:"2"|intcomma }}</td></tr>
		<tr><td><em>Products</em></td><td><em>${{ this_months_book.product_cost|floatformat:"2"|intcomma }} ({% widthratio this_months_book.product_cost|floatformat:"2" this_months_book.revenue|floatformat:"2" 100 %}%)</em></td></tr>
		<tr><td><em>Shipping</em></td><td><em>${{ this_months_book.shipping_cost|floatformat:"2"|intcomma }} ({% widthratio this_months_book.shipping_cost|floatformat:"2" this_months_book.revenue|floatformat:"2" 100 %}%)</em></td></tr>
		<tr><td><em>Prizes</em></td><td><em>${{ this_months_book.prize_cost|floatformat:"2"|intcomma }} ({% widthratio this_months_book.prize_cost|floatformat:"2" this_months_book.revenue|floatformat:"2" 100 %}%)</em></td></tr>
		<tr><td><em>Packaging</em></td><td><em>${{ this_months_book.packaging_cost|floatformat:"2"|intcomma }} ({% widthratio this_months_book.packaging_cost|floatformat:"2" this_months_book.revenue|floatformat:"2" 100 %}%)</em></td></tr>
		<tr><td><em>Prints</em></td><td><em>${{ this_months_book.prints_cost|floatformat:"2"|intcomma }} ({% widthratio this_months_book.prints_cost|floatformat:"2" this_months_book.revenue|floatformat:"2" 100 %}%)</em></td></tr>
		<tr><td><em>Fees</em></td><td><em>${{ this_months_book.stripe_fee|floatformat:"2"|intcomma }} ({% widthratio this_months_book.stripe_fee|floatformat:"2" this_months_book.revenue|floatformat:"2" 100 %}%)</em></td></tr>
		<tr><td>Profit</td><td>${{ this_months_book.profit|floatformat:"2"|intcomma }} ({% widthratio this_months_book.profit|floatformat:"2" this_months_book.revenue|floatformat:"2" 100 %}%)</td></tr>
	</tbody>
</table>

<form action="" method="post">{% csrf_token %}
	<table width="60%">
		<tr>
			<td>Add lineitem:</td>
			<td><input type="text" name="amt" placeholder="amount"></td>
			<td>
				<select name="lineitem">
					<option value="prize_cost">prizes</option>
					<option value="prints_cost">prints</option>
					<option value="packaging_cost">packaging</option>
					<option value="shipping_cost">shipping</option>
					<option value="stripe_fees">fees</option>
					<option value="product_cost">products</option>
				</select>
			</td>
			<td>
				<input type="submit" value="Submit">
			</td>
		</tr>
	</table>
</form>

{% if unpaid %}
{% for order in unpaid|slice:":10" %}
	<li>{{ order }} - ${{ order.choice.price|floatformat:2 }}</li>
{% endfor %}

<p>Total orders: {{ total_count }}</p>
{% endif %}

{% endblock %}